extends layout

block content
  .container-fluid.mx-4.my-4
    //- Asset List Header
    .row.mb-4
      .col-12
        h1.text-center.mb-4 Asset List

    //- Form to Add/Edit Asset
    .row.mb-4
      .col-md-12
        .card.bg-light.border-primary.shadow-lg
          .card-body
            h5.card-title.text-primary Add New Asset
            form(action='/assets/add' method='POST')
              .row
                .col-md-4.mb-3
                  .form-group
                    label(for='serialNumber') Serial Number
                    input.form-control(type='text' id='serialNumber' name='serialNumber' placeholder='Enter serial number' required)
                .col-md-4.mb-3
                  .form-group
                    label(for='uniqueId') Unique ID
                    input.form-control(type='text' id='uniqueId' name='uniqueId' placeholder='Enter unique ID' required)
                .col-md-4.mb-3
                  .form-group
                    label(for='make') Make
                    input.form-control(type='text' id='make' name='make' placeholder='Enter make')
              .row
                .col-md-4.mb-3
                  .form-group
                    label(for='model') Model
                    input.form-control(type='text' id='model' name='model' placeholder='Enter model')
                .col-md-4.mb-3
                  .form-group
                    label(for='assetCategoryId') Category
                    select.form-control(name='assetCategoryId' id='assetCategoryId')
                      option(value='') Select Category
                      each category in categories
                        option(value=category.id)= category.name
                .col-md-4.mb-3
                  .form-group
                    label(for='status') Status
                    input.form-control(type='text' id='status' name='status' placeholder='Enter status')
              .row
                .col-md-4.mb-3
                  .form-group
                    label(for='location') Location
                    input.form-control(type='text' id='location' name='location' placeholder='Enter location')
                .col-md-4.mb-3
                  .form-group
                    label(for='purchaseDate') Purchase Date
                    input.form-control(type='date' id='purchaseDate' name='purchaseDate' placeholder='Enter purchase date')
                .col-md-4.mb-3
                  .form-group
                    label(for='cost') Cost
                    input.form-control(type='number' id='cost' name='cost' placeholder='Enter cost')
              .form-group.mt-3
                button.btn.btn-primary.btn-lg(type='submit') Add Asset

    //- Data Table with Filters
    .row
      .col-12
        .card
          .card-body
            h5.card-title.text-primary Asset Filters
            .row
              .col-md-4.mb-3
                .form-group
                  label(for='filterType') Filter by Type
                  select.form-control(id='filterType')
                    option(value='') Select Type
                    // Add more filter options here
              .col-md-4.mb-3
                .form-group
                  label(for='searchMakeModel') Search by Make/Model
                  input.form-control(type='text' id='searchMakeModel' placeholder='Enter make or model')
              .col-md-4.mb-3
                .form-group.mt-4
                  button.btn.btn-primary(type='button' id='applyFilters') Apply Filters

    //- Data Table with Scroll
    .row
      .col-12
        .table-responsive
          table.table.table-striped.table-bordered#assetTable
            thead.bg-primary.text-white
              tr
                th Serial Number
                th Unique ID
                th Make
                th Model
                th Category
                th Status
                th Location
                th Purchase Date
                th Cost
                th Actions
            tbody
              each asset in assets
                tr
                  td= asset.serialNumber
                  td= asset.uniqueId
                  td= asset.make
                  td= asset.model
                  td= asset.category ? asset.category.name : 'No Category'
                  td= asset.status
                  td= asset.location
                  td= new Date(asset.purchaseDate).toLocaleDateString('en-GB')
                  td= asset.cost
                  td
                    a.btn.btn-warning.btn-sm(href=`#` data-toggle='modal' data-target=`#editModal${asset.id}`) Edit
                    button.btn.btn-danger.btn-sm(type='button', data-toggle='modal', data-target=`#deleteModal${asset.id}`) Delete

                    //- Modal for Editing
                    .modal.fade(id=`editModal${asset.id}`, tabindex='-1', role='dialog')
                      .modal-dialog(role='document')
                        .modal-content
                          .modal-header
                            h5.modal-title Edit Asset
                            button.close(type='button', data-dismiss='modal', aria-label='Close')
                              span(aria-hidden='true') ×
                          .modal-body
                            form(action=`/assets/edit/${asset.id}` method='POST')
                              .form-group
                                label(for='serialNumber') Serial Number
                                input.form-control(type='text' id='serialNumber' name='serialNumber' value=asset.serialNumber readonly)
                              .form-group
                                label(for='uniqueId') Unique ID
                                input.form-control(type='text' id='uniqueId' name='uniqueId' value=asset.uniqueId readonly)
                              .form-group
                                label(for='make') Make
                                input.form-control(type='text' id='make' name='make' value=asset.make required)
                              .form-group
                                label(for='model') Model
                                input.form-control(type='text' id='model' name='model' value=asset.model required)
                              .form-group
                                label(for='assetCategoryId') Category
                                select.form-control(name='assetCategoryId' id='assetCategoryId')
                                  option(value='') Select Category
                                  each category in categories
                                    option(value=category.id selected=(asset.assetCategoryId === category.id))= category.name
                              .form-group
                                label(for='status') Status
                                input.form-control(type='text' id='status' name='status' value=asset.status)
                              .form-group
                                label(for='location') Location
                                input.form-control(type='text' id='location' name='location' value=asset.location)
                              .form-group
                                label(for='purchaseDate') Purchase Date
                                input.form-control(type='date' id='purchaseDate' name='purchaseDate' value=(new Date(asset.purchaseDate)).toISOString().split('T')[0])
                              .form-group
                                label(for='cost') Cost
                                input.form-control(type='number' id='cost' name='cost' value=asset.cost)
                              button.btn.btn-primary(type='submit') Save changes
                          .modal-footer
                            button.btn.btn-secondary(type='button', data-dismiss='modal') Close


                    //- Modal for Deleting
                    .modal.fade(id=`deleteModal${asset.id}`, tabindex='-1', role='dialog')
                      .modal-dialog(role='document')
                        .modal-content
                          .modal-header
                            h5.modal-title Delete Asset
                            button.close(type='button', data-dismiss='modal', aria-label='Close')
                              span(aria-hidden='true') ×
                          .modal-body
                            p Are you sure you want to delete this asset?
                          .modal-footer
                            button.btn.btn-secondary(type='button', data-dismiss='modal') Cancel
                            a.btn.btn-danger(href=`/assets/delete/${asset.id}`) Delete

  //- Scripts
  script(src='https://code.jquery.com/jquery-3.5.1.min.js')
  script(src='https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js')
  script(src='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js')
  script.
    $(document).ready(function() {
      $('#assetTable').DataTable({
        responsive: true,
        "scrollY": "400px",
        "scrollCollapse": true,
        "paging": true
      });
    });
  script.
    $('#applyFilters').click(function() {
      // Add filter logic here
    });
